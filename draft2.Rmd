---
title: 'Can money buy happiness?'
author: "Jocelyn Radke, Ana Espeleta, Cat Terres"
output: 
  html_document:
    keep_md: TRUE
    toc: TRUE
    toc_float: TRUE
    df_print: paged
    code_download: true
---

```{r setup, include=FALSE}
#knitr::opts_chunk$set(echo = TRUE, error=TRUE, message=FALSE, warning=FALSE)
```

```{r}
#Loading the packages
library(dplyr)
library(readr)
library(ggplot2)
library(gridExtra)
library(tidyverse)
library(lubridate) 
library(ggthemes)
library(plotly)
library(ggdark)
library(maps)
library(ggmap)
library(leaflet)
library(RColorBrewer)
```

## Introduction and Background

Can money buy happiness? Philosophers, university students, and lay people alike have grappled with this question for ages. The knee-jerk reaction is to emphatically reject a link between life satisfaction and financial abundance because everyone knows both miserable wealthy people and others who appear incredibly joyful despite severe financial difficulties. As one rapper (The Notorious B.I.G.) insightfully observed that, “Mo Money Mo Problems,” which illustrates that affluence prompts challenges of its own. Some researchers have turned to empirical testing to seek an answer to this question. One study by [Jachimowicz](https://www.hbs.edu/ris/Publication%20Files/FinancialScarcity_SPPS_accepted_November1_2021_06f87dd3-4474-4c92-88d1-a5c6b63a2eaa.pdf) and colleagues found that financial instability correlates with higher levels of daily distress. Although money alone doesn’t imply happiness, money can eliminate daily hardships that lead to life dissatisfaction. A 2010 [Princeton](https://spia.princeton.edu/sites/default/files/content/docs/news/Happiness_Money_Summary.pdf) study measured that a $75,000 annual income was the “sweet spot” for maximizing emotional well-being. Incomes below this benchmark were correlated with lower levels of happiness and higher levels of stress. These research studies and our own analysis seek to make a connection between standards of living (a quantitative measure) and quality of life (a qualitative measure). A standard of living measures the material well-being of people in a given geographical population which is reflected in factors such as comfort, access to opportunities, goods, healthcare services, and safety. Quality of life, on the other hand, is a more subjective term that reflects the level of happiness of a population, which certainly varies person to person.

> “Wealth consists not in having great possessions, but in having few wants.” – Epictetus, stoic philosopher

Economic performance is a common determinate of standard of living within a country. The reasoning goes that a country that functions well economically is able to provide stable income and access to jobs, increase the availability of goods and services, and afford a social safety net. The most common measure of standard of living is gross domestic product (GDP), which is a measure of the total volume of goods and services produced within in country in a given year. We paired GDP data with population data to calculate GDP per capita (thereafter, GDPPC) so as to control for differences in population between countries. We believe that GDPPC provides a helpful, though imperfect measure of the standard of living within a country. GDPPC operates with the assumption that every individual within a country gets an equal slice of the GDP pie, which is unrealistic because of widespread income inequality, however, can provide insight as long as we are mindful of its limitations. In what follows, we seek to challenge the assumption that the best countries are those that are most economically successful though looking at measures of quality of living in addition to standard of living. 

## Data Collection
- Healthy living report (main source)- [Healthy Lifestyle Cities Report 2021](https://www.kaggle.com/datasets/prasertk/healthy-lifestyle-cities-report-2021)
- GDP info (supplementary source)- [GDP data source](https://worldpopulationreview.com/countries/countries-by-gdp)
- Hours worked info (supplementary source)- [new hours worked data (Penn)](https://worldpopulationreview.com/country-rankings/average-work-week-by-country)

## Analysis

```{r}
#Loading the data
healthy_data <- read_csv("healthy_lifestyle_city_2021.csv", 
    col_types = cols(Rank = col_number(), 
        `Sunshine hours(City)` = col_number(), 
        `Cost of a bottle of water(City)` = col_number(), 
        `Obesity levels(Country)` = col_number(), 
        `Life expectancy(years) (Country)` = col_number(), 
        `Pollution(Index score) (City)` = col_number(), 
        `Annual avg. hours worked` = col_number(), 
        `Happiness levels(Country)` = col_number(), 
        `Outdoor activities(City)` = col_number(),
        `Number of take out places(City)` = col_number(), 
        `Cost of a monthly gym membership(City)` = col_number()))

supplemental_data <- read_csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vQL_6se7aBLQSP92RgP5DkvQ_quTyzsTxskf9ZFpvE_5ifMS5whQ1Lr0JRNMtd1ZGAaVXlEEMECPMHr/pub?output=csv", 
    col_types = cols(GDPM = col_number(), 
        GDP = col_number(), pop = col_number(), 
        GDPPC = col_number()))

#Joining data and converting pounds to dollars
healthy_data_2 <- healthy_data %>% 
  left_join(supplemental_data,
            by = c("City" = "city")) %>% 
  mutate(water_bottle_cost = `Cost of a bottle of water(City)`*1.3,
         gym_cost = `Cost of a monthly gym membership(City)`*1.3)
```
Here is a map of the cities included in the analysis. European cities are likely overrepresented because the data was compiled by a UK-based company.  
```{r}
labels <- sprintf(
  "<strong>%s</strong><br/> %s",
  healthy_data_2$City, healthy_data_2$country) %>%
  lapply(htmltools::HTML)

leaflet(data = healthy_data_2) %>% 
  addProviderTiles(providers$CartoDB.Positron) %>%
  addCircleMarkers(
    radius = 4,
    color = "#D4A200",
    stroke = FALSE, 
    fillOpacity = 0.7,
    label = ~labels
  )
```

> Because economic performance is a common standard for measuring the success of a given country, we chose to investigate if there is a correlation between gross domestic product (GDP), which is a measure of the total volume of goods and services produced within in country in a given year, and happiness levels as calculated by the **survey**. We see that countries with higher GDPPC tend to correlate with higher happiness levels than countries with lower GDPPC. We wondered if countries with a higher GDPPC would be more unhappy reflecting that they may work longer hours in order to have such a high level of production. It is possible that rather than hours worked, GDP reflects differences in technology, production processes, management, or human capital.    


```{r}
options(scipen=999)

ggplot(healthy_data_2, aes(y = fct_reorder(country, GDPPC), x = GDPPC, color = `Happiness levels(Country)`)) +
  geom_point() +
  labs(title = "Gross Domestic Product per Capita by Country and Happiness Level",
       caption = "Data from: ADD LATER",
       x = "GDP per capita (USD)",
       y = "",
       color = "Happiness Level 
       (1-10 scale)") +
  theme(plot.title = element_text(hjust = 1)) +
  theme_classic() +
  scale_color_gradient(high = "#FFD25A", low = "black")
```


Cat's graph(s):

> We chose three variables that we think are important contributing factors to overall happiness, influenced of course by where we are and salient factors we feel attuned to. Our variables, life expectancy, sunshine hours, and hours worked, are compared against overall happiness for each place to see if there is a correlation between more or less of each variable. We are also keeping in mind intangible factors such as state of mind and the impacts of cultural attitudes. 

```{r, r.height = 20, r.width = 15, fig.alt= "This dot plot compares the level of happiness to the sunshine hours in 43 different locations from the Healthy Lifestyle Cities Report 2021. The dots are all assigned a color based on location, and plotted at each discrete point. There appears to be no strong correlation between isolating the sunshine hours and comparing them to the happiness level. More factors combine to make up overall happiness."}
healthy_lifestyle_data_cat <- healthy_data_dollars[-c(20),]

healthy_lifestyle_data_cat2 <- healthy_lifestyle_data_cat %>% 
  select(`City`, `Happiness levels(Country)`, `Sunshine hours(City)`) %>% 
  
  ggplot(aes(x = `Happiness levels(Country)`, 
             y = factor(`Sunshine hours(City)`), 
             color = (`City`))) +
  geom_count() +
  scale_y_discrete(breaks = c(1405, 1884, 2363, 2983, 3542))+
  
  labs(title = "Is there a correlation between sunshine hours and happiness levels?",
       x = "Happiness Level",
       y = "Sunshine Hours",
       caption = "Graph By Cat Terres; data sourced from Kaggle, 
       'Healthy Lifestyle Cities Report 2021'") +
  
  theme_foundation() +
  theme(legend.title=element_blank())+
  theme(legend.background = element_blank())
```

plotly for cities
```{r}
ggplotly(healthy_lifestyle_data_cat2,
         tooltip = c("text", 
                     "x",
                     "(City)"))
```

Life expectancy vs. Happiness (factor in city)
Does happiness affect life expectancy?

```{r, fig.alt= "For this graph, the cities have been placed into bins based on the happiness level and the range they fall into. For example, a country with a happiness level of 4.5 would be placed within the box plot above the 4-5 on the x axis. They are then plotted using upper and lower quartiles to show the distribution of life expectancies."}
bin_size <- 1
healthy_data_dollars %>% 
  select("City" = `City`, "Happiness Level" = `Happiness levels(Country)`, "Life Expectancy" = `Life expectancy(years) (Country)`) %>% 
  arrange(desc(`Life Expectancy`)) %>% 
 
  mutate(bin_dist = paste(as.character(as.integer(`Happiness Level`)),as.character(as.integer(`Happiness Level`+1)), sep = "-")) %>%  
  ggplot() +
  geom_boxplot(aes(x = factor(bin_dist), 
         y = `Life Expectancy`,
         outlier.color = NULL,
         fill = bin_dist
         )) +
  labs(title = "Does reported greater happiness have a positive effect on life expectancy?",
       x = "Happiness Level",
       y = "Life Expectancy",
       fill = "") +
  
  
  guides(y = guide_axis(angle = 45))
  
  
```

Hours Worked vs. Happiness (factor in city)
Is there a correlation between happiness and hours worked?


```{r, fig.alt= "This graph displays various cities with their own color coded dot based on happiness level (x axis) and weekly hours worked (y axis). There is a loose correlation between greater happiness and fewer weeky work hours. The dots are able to be scrolled over with the cursor, displaying exact happiness level, exact work hours, and city."}
healthy_data_dot <- healthy_data_2 [-c(23),]

Healthy <- healthy_data_dot %>% 
  select(`City`, "Happiness Level" = `Happiness levels(Country)`, "Average Weekly Hours Worked" = `Hours Worked`) %>% 
  mutate(`Avg. Weekly Hours Worked` = factor(`Average Weekly Hours Worked`)) %>% 
  
  #mutate(bin_dist = paste(as.character(as.integer(`Happiness Level`)),as.character(as.integer(`Happiness Level`+1)), sep = "-")) %>% 
  
 ggplot(aes(x = `Happiness Level`, 
             y = `Avg. Weekly Hours Worked`, 
             color = `City`)) +
  geom_point() +
  scale_y_discrete(breaks = c(26.6, 30.6, 33.2, 38.8, 42.1))+
  
  labs(title = "Is there a correlation between weekly work hours and happiness levels?",
       x = "Happiness Level",
       y = "",
       caption = "Graph By Cat Terres; data sourced from Kaggle, 
       'Healthy Lifestyle Cities Report 2021'",
       color = "") +
  
  theme_foundation() +
  theme(legend.title=element_blank())+
  theme(legend.background = element_blank()) 
  
```

```{r}
ggplotly(Healthy,
         tooltip = c("text",
                     "y",
                     "x",
                     "City"))
```





#GDPPC vs. Hours Worked (Can we observe a relationship between the GDPC of each contry and the average amount of hours people work per week?) Can the observable patterns tell us something about the contries with low GDPC and a higher number of working hours? How can we relate this to happiness?

```{r}
country_GDP <- read_csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vQL_6se7aBLQSP92RgP5DkvQ_quTyzsTxskf9ZFpvE_5ifMS5whQ1Lr0JRNMtd1ZGAaVXlEEMECPMHr/pub?output=csv", 
    col_types = cols(GDPM = col_number(), 
        GDP = col_number(), pop = col_number(), 
        GDPPC = col_number()))


healthy_data_2 <- healthy_data_dollars %>% 
  left_join(country_GDP,
            by = c("City" = "city"))

options(scipen=999)

GDPP_hours <- healthy_data_2 %>% 
ggplot( aes(x = GDPPC, y = `Hours Worked`, color = `City`)) +
  geom_point() +
  labs(title = "Gross Domestic Product per Capita by Country and Average Weekly Hours Worked",
       caption = "Data from: ADD LATER",
       x = "GDP per capita (USD)",
       y = "Hours Worked (Weekly)",
       color = "") +
  theme(legend.position = "none",
        panel.background = element_rect(fill = "lightblue",
                                colour = "gray",
                                size = 0.5,
                                ),
        plot.title = element_text(size = 0.05))


ggplotly(GDPP_hours,
         tooltip = c("text", 
                     "x",
                     "City"))
```